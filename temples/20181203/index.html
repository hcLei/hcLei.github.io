<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>React-Router v4实战开发总结</title>
    <link rel='stylesheet' href='../../public/markdown.min.css' />
    <link rel='stylesheet' href='../../public/style.css' />
    <link rel="icon" type="image/png" href="../../public/images/icon.png" sizes="32x32">
    <meta name="description"
        content="个人博客网站，专注于分享技术知识，包括但不限于HTML5、CSS3、JavaScript、Nodejs、Linux、Python、Nginx、React、Vue、Angular">
    <meta name="keywords"
        content="个人、博客、技术、互联网、分享、笔记、前端开发、HTML5、CSS3、JavaScript、Nodejs、Linux、Python、Nginx、React、Vue、Angular">
</head>

<body>
    <header class="header">
        <div class="header-inner">
            <div class="header-title">
                <a href="../../">致力于分享与进步</a>
            </div>
        </div>
    </header>
    <main class="main">
        <div class="main-inner">
            <div class="content-item">
                <p class="content-title"><a>React-Router v4实战开发总结</a></p>
                <p class="content-createTime"><img src="../../public/images/date.svg" alt="date">发表于 2018-12-03</p>
            </div>
            <div class="content-description">
                <p>在项目开发之前去了<code>React-Router v4</code>的官网大概浏览了一遍知识点，并手动演示了部分demo，然后按照指导进行开发，在开发过程中遇到了一些问题，也借鉴了网上的一些教程，最终整理出来了这篇实战开发总结。
                </p>
                <pre class="prettyprint linenums prettyprinted"
                    style=""><ol class="linenums"><li class="L0"><code><span class="com">//引入react-router</span></code></li><li class="L1"><code><span class="pln">npm install react</span><span class="pun">-</span><span class="pln">router </span><span class="pun">--</span><span class="pln">save</span></code></li></ol></pre>
                <hr>
                <p>默认安装的是最新的4.X版本，根据官网描述，v4使用的是万物皆组件的思想，所有的路由配置不用集中写到一起，而是可以被嵌套到各个代码模块中。react-router v4被拆分成了三个包：</p>
                <ol>
                    <li>react-router :只提供核心的路由和函数，一般不会使用。</li>
                    <li>react-router-dom :供浏览器/Web应用使用的API。</li>
                    <li>react-router-native:供 React Native 应用使用的API。</li>
                </ol>
                <p>平时开发使用的时候只需要引入react-router-dom就行了。</p>
                <pre class="prettyprint linenums prettyprinted"
                    style=""><ol class="linenums"><li class="L0"><code><span class="kwd">import</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="typ">BrowserRouter</span><span class="pln"> </span><span class="kwd">as</span><span class="pln"> </span><span class="typ">Router</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Route</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Link</span><span class="pln"> </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">from</span><span class="pln"> </span><span class="str">"react-router-dom"</span><span class="pun">;</span></code></li></ol></pre>
                <p><strong>1. <code>&lt;Router&gt;</code>用法</strong></p>
                <p>路由分为browserHistory和hashHistory，两者是有区别的。最明显的区别是 hashHistory 的URL路径是以#开头的。对于 browserHistory
                    需要server端的支持，因为每次地址改变请求的都是服务端真实的文件路径，不然的话页面总是空白的。但 hashHistory 就不需要了，因为改变的是#号后面的hash值，浏览器并不会重新发起请求。
                </p>
                <p>v4版本的<code>&lt;Router&gt;</code>组件只允许存在一个子元素，若有多个则需要使用div包裹起来，不然就会报错：<code>A &lt;Router&gt; may have only one child element</code>。正确用法如下(官网示例)
                </p>
                <pre class="prettyprint linenums prettyprinted"
                    style=""><ol class="linenums"><li class="L0"><code><span class="tag">&lt;Router&gt;</span></code></li><li class="L1"><code><span class="pln"> </span><span class="tag">&lt;div&gt;</span><span class="pln"> //需要加个div</span></code></li><li class="L2"><code><span class="pln"> </span><span class="tag">&lt;nav&gt;</span></code></li><li class="L3"><code><span class="pln"> </span><span class="tag">&lt;ul&gt;</span></code></li><li class="L4"><code><span class="pln"> </span><span class="tag">&lt;li&gt;</span></code></li><li class="L5"><code><span class="pln"> </span><span class="tag">&lt;Link</span><span class="pln"> </span><span class="atn">to</span><span class="pun">=</span><span class="atv">"/"</span><span class="tag">&gt;</span><span class="pln">Home</span><span class="tag">&lt;/Link&gt;</span></code></li><li class="L6"><code><span class="pln"> </span><span class="tag">&lt;/li&gt;</span></code></li><li class="L7"><code><span class="pln"> </span><span class="tag">&lt;li&gt;</span></code></li><li class="L8"><code><span class="pln"> </span><span class="tag">&lt;Link</span><span class="pln"> </span><span class="atn">to</span><span class="pun">=</span><span class="atv">"/about/"</span><span class="tag">&gt;</span><span class="pln">About</span><span class="tag">&lt;/Link&gt;</span></code></li><li class="L9"><code><span class="pln"> </span><span class="tag">&lt;/li&gt;</span></code></li><li class="L0"><code><span class="pln"> </span><span class="tag">&lt;li&gt;</span></code></li><li class="L1"><code><span class="pln"> </span><span class="tag">&lt;Link</span><span class="pln"> </span><span class="atn">to</span><span class="pun">=</span><span class="atv">"/users/"</span><span class="tag">&gt;</span><span class="pln">Users</span><span class="tag">&lt;/Link&gt;</span></code></li><li class="L2"><code><span class="pln"> </span><span class="tag">&lt;/li&gt;</span></code></li><li class="L3"><code><span class="pln"> </span><span class="tag">&lt;/ul&gt;</span></code></li><li class="L4"><code><span class="pln"> </span><span class="tag">&lt;/nav&gt;</span></code></li><li class="L5"><code></code></li><li class="L6"><code><span class="pln"> </span><span class="tag">&lt;Route</span><span class="pln"> </span><span class="atn">path</span><span class="pun">=</span><span class="atv">"/"</span><span class="pln"> </span><span class="atn">exact</span><span class="pln"> </span><span class="atn">component</span><span class="pun">=</span><span class="atv">{Index}</span><span class="pln"> </span><span class="tag">/&gt;</span></code></li><li class="L7"><code><span class="pln"> </span><span class="tag">&lt;Route</span><span class="pln"> </span><span class="atn">path</span><span class="pun">=</span><span class="atv">"/about/"</span><span class="pln"> </span><span class="atn">component</span><span class="pun">=</span><span class="atv">{About}</span><span class="pln"> </span><span class="tag">/&gt;</span></code></li><li class="L8"><code><span class="pln"> </span><span class="tag">&lt;Route</span><span class="pln"> </span><span class="atn">path</span><span class="pun">=</span><span class="atv">"/users/"</span><span class="pln"> </span><span class="atn">component</span><span class="pun">=</span><span class="atv">{Users}</span><span class="pln"> </span><span class="tag">/&gt;</span></code></li><li class="L9"><code><span class="pln"> </span><span class="tag">&lt;/div&gt;</span></code></li><li class="L0"><code><span class="tag">&lt;/Router&gt;</span></code></li></ol></pre>
                <p><strong>2. <code>&lt;Route&gt;</code>用法</strong></p>
                <p><strong>2.1:</strong> Route组件的作用就是当一个location匹配路由的path时，渲染某些UI，有三个属性：</p>
                <blockquote>
                    <p>path（string）: 路由匹配路径。没有path属性的Route
                        总是会被匹配到,通常用于404页面。<br>exact（bool）：为true时，则要求路径与location.pathname必须完全匹配，通常用于匹配首页。<br>strict（bool）：true的时候，有结尾斜线的路径只能匹配有斜线的location.pathname，用得比较少。
                    </p>
                </blockquote>
                <p><strong>2.2：</strong><code>&lt;Route&gt;</code>提供三种渲染方式：<code>&lt;Route component&gt;</code>、
                    <code>&lt;Route render&gt;</code>、
                    <code>&lt;Route children&gt;</code>。<code>&lt;Route component&gt;</code>的优先级要比<code>&lt;Route render&gt;</code>高，所以不要在同一个<code>&lt;Route&gt;</code>中同时使用。
                </p>
                <p><code>&lt;Route component&gt;</code>：平常用得最多的就是这种了，可以传递参数到子组件中，也可以传递方法到子组件，这样的话可以在子组件中调用父组件的方法来改变父组件的某些值。
                </p>
                <pre class="prettyprint linenums prettyprinted"
                    style=""><ol class="linenums"><li class="L0"><code><span class="kwd">import</span><span class="pln"> A </span><span class="kwd">from</span><span class="pln"> </span><span class="str">'./xx'</span><span class="pun">;</span></code></li><li class="L1"><code><span class="pun">&lt;</span><span class="typ">Route</span><span class="pln"> path</span><span class="pun">=</span><span class="str">"/a"</span><span class="pln"> </span><span class="kwd">params</span><span class="pun">={}</span><span class="pln"> handel</span><span class="pun">={}</span><span class="pln"> component </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> A </span><span class="pun">}/&gt;</span></code></li></ol></pre>
                <p><code>&lt;Route render&gt;</code>：这种方式对于<strong>内联渲染</strong>和<strong>包装组件</strong>却不引起意料之外的重新挂载特别方便。<br><strong>内联渲染</strong>：有个场景，父组件A有个age属性，可以手动加减，而age的值需要在子组件B中展示，如果采用<code>&lt;Route component&gt;</code>，先在B组件的生命周期函数componentDidMount里放个console.log，当A每次进行加减操作时，B组件就会频繁的进行挂载，每次都会执行console.log。
                </p>
                <p>因为<code>&lt;Route component&gt;</code>每次都要React.createElement，每次Render生成新的组件，状态前后不一致触发了dom更新。但内联组件可以避免这种情况，代码如下:
                </p>
                <pre class="prettyprint linenums prettyprinted"
                    style=""><ol class="linenums"><li class="L0"><code><span class="com">// convenient inline rendering</span></code></li><li class="L1"><code><span class="kwd">class</span><span class="pln"> A </span><span class="kwd">extends</span><span class="pln"> </span><span class="typ">Component</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L2"><code><span class="pln"> constructor</span><span class="pun">(</span><span class="pln">prop</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L3"><code><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">state </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln">age</span><span class="pun">:</span><span class="pln"> </span><span class="lit">1</span><span class="pun">}</span></code></li><li class="L4"><code><span class="pln"> </span><span class="pun">}</span></code></li><li class="L5"><code><span class="pln"> handleClick </span><span class="pun">=</span><span class="pln"> </span><span class="pun">()</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L6"><code><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">setState</span><span class="pun">(</span><span class="pln">state </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="pun">({</span><span class="pln">age</span><span class="pun">:</span><span class="pln"> state</span><span class="pun">.</span><span class="pln">age </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">}))</span></code></li><li class="L7"><code><span class="pln"> </span><span class="pun">};</span></code></li><li class="L8"><code><span class="pln"> render</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L9"><code><span class="pln"> </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">(</span></code></li><li class="L0"><code><span class="pln"> </span><span class="str">&lt;div&gt;</span></code></li><li class="L1"><code><span class="pln"> </span><span class="str">&lt;div&gt;</span></code></li><li class="L2"><code><span class="pln"> </span><span class="pun">{</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">state</span><span class="pun">.</span><span class="pln">age</span><span class="pun">}</span></code></li><li class="L3"><code><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">button onClick</span><span class="pun">={</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">handleClick</span><span class="pun">}&gt;</span><span class="pln">add</span><span class="pun">&lt;/</span><span class="pln">button</span><span class="pun">&gt;</span></code></li><li class="L4"><code><span class="pln"> </span><span class="pun">&lt;/</span><span class="pln">div</span><span class="pun">&gt;</span></code></li><li class="L5"><code><span class="pln"> </span><span class="str">&lt;div&gt;</span></code></li><li class="L6"><code><span class="pln"> </span><span class="pun">&lt;</span><span class="typ">Router</span><span class="pun">&gt;</span></code></li><li class="L7"><code><span class="pln"> </span><span class="pun">&lt;</span><span class="typ">Route</span><span class="pln"> render</span><span class="pun">={()</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="pun">(&lt;</span><span class="pln">B age</span><span class="pun">={</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">state</span><span class="pun">.</span><span class="pln">age</span><span class="pun">}</span><span class="pln"> </span><span class="pun">/&gt;)}</span><span class="pln"> </span><span class="pun">/&gt;</span></code></li><li class="L8"><code><span class="pln"> </span><span class="pun">&lt;/</span><span class="typ">Router</span><span class="pun">&gt;</span></code></li><li class="L9"><code><span class="pln"> </span><span class="pun">&lt;/</span><span class="pln">div</span><span class="pun">&gt;</span></code></li><li class="L0"><code><span class="pln"> </span><span class="pun">&lt;/</span><span class="pln">div</span><span class="pun">&gt;</span></code></li><li class="L1"><code><span class="pln"> </span><span class="pun">);</span></code></li><li class="L2"><code><span class="pln"> </span><span class="pun">}</span></code></li><li class="L3"><code><span class="pun">}</span></code></li></ol></pre>
                <p><strong>包装组件</strong>：举个例子，比如登陆认证，代码如下：</p>
                <pre class="prettyprint linenums prettyprinted"
                    style=""><ol class="linenums"><li class="L0"><code><span class="com">//auth.js</span></code></li><li class="L1"><code><span class="kwd">import</span><span class="pln"> </span><span class="typ">React</span><span class="pun">,</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="typ">Component</span><span class="pln"> </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">from</span><span class="pln"> </span><span class="str">'react'</span><span class="pun">;</span></code></li><li class="L2"><code><span class="kwd">import</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="typ">Route</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Redirect</span><span class="pln"> </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">from</span><span class="pln"> </span><span class="str">'react-router-dom'</span><span class="pun">;</span></code></li><li class="L3"><code></code></li><li class="L4"><code><span class="kwd">class</span><span class="pln"> </span><span class="typ">AuthRouter</span><span class="pln"> </span><span class="kwd">extends</span><span class="pln"> </span><span class="typ">Component</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L5"><code><span class="pln"> render</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L6"><code><span class="pln"> </span><span class="kwd">const</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> component</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Component</span><span class="pun">,</span><span class="pln"> </span><span class="pun">...</span><span class="pln">rest </span><span class="pun">}</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">props</span></code></li><li class="L7"><code><span class="pln"> </span><span class="kwd">const</span><span class="pln"> isAuth</span></code></li><li class="L8"><code><span class="pln"> </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">(</span></code></li><li class="L9"><code><span class="pln"> </span><span class="pun">&lt;</span><span class="typ">Route</span><span class="pln"> </span><span class="pun">{...</span><span class="pln">rest</span><span class="pun">}</span><span class="pln"> render</span><span class="pun">={</span><span class="pln">props </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L0"><code><span class="pln"> </span><span class="kwd">return</span><span class="pln"> isAuth</span></code></li><li class="L1"><code><span class="pln"> </span><span class="pun">?</span><span class="pln"> </span><span class="pun">&lt;</span><span class="typ">Component</span><span class="pln"> </span><span class="pun">{...</span><span class="pln">props</span><span class="pun">}</span><span class="pln"> </span><span class="pun">/&gt;</span></code></li><li class="L2"><code><span class="pln"> </span><span class="pun">:</span><span class="pln"> </span><span class="pun">&lt;</span><span class="typ">Redirect</span><span class="pln"> to</span><span class="pun">=</span><span class="str">"/login"</span><span class="pln"> </span><span class="pun">/&gt;</span></code></li><li class="L3"><code><span class="pln"> </span><span class="pun">}}</span><span class="pln"> </span><span class="pun">/&gt;</span></code></li><li class="L4"><code><span class="pln"> </span><span class="pun">)</span></code></li><li class="L5"><code><span class="pln"> </span><span class="pun">}</span></code></li><li class="L6"><code><span class="pun">}</span></code></li><li class="L7"><code></code></li><li class="L8"><code><span class="kwd">export</span><span class="pln"> </span><span class="kwd">default</span><span class="pln"> </span><span class="typ">AuthRouter</span><span class="pun">;</span></code></li><li class="L9"><code></code></li><li class="L0"><code><span class="com">//route.js</span></code></li><li class="L1"><code><span class="kwd">import</span><span class="pln"> </span><span class="typ">AuthRouter</span><span class="pln"> </span><span class="kwd">from</span><span class="pln"> </span><span class="str">"./AuthRouter"</span><span class="pun">;</span></code></li><li class="L2"><code></code></li><li class="L3"><code><span class="pun">&lt;</span><span class="typ">AuthRouter</span><span class="pln"> path</span><span class="pun">=</span><span class="str">'/user'</span><span class="pln"> component</span><span class="pun">={</span><span class="typ">User</span><span class="pun">}</span><span class="pln"> </span><span class="pun">/&gt;</span></code></li></ol></pre>
                <p><code>&lt;Route children&gt;</code>: 类似于render，但是不管路由是否匹配都会渲染对应组件，平时基本没有使用，具体说明可参考<a
                        href="https://reacttraining.com/react-router/web/api/Route/children-func">官网</a>。用法如下:</p>
                <pre class="prettyprint linenums prettyprinted"
                    style=""><ol class="linenums"><li class="L0"><code><span class="kwd">const</span><span class="pln"> </span><span class="typ">OldSchoolMenuLink</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">({</span><span class="pln"> label</span><span class="pun">,</span><span class="pln"> to</span><span class="pun">,</span><span class="pln"> activeOnlyWhenExact </span><span class="pun">})</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="pun">(</span></code></li><li class="L1"><code><span class="pln"> </span><span class="pun">&lt;</span><span class="typ">Route</span><span class="pln"> path</span><span class="pun">={</span><span class="pln">to</span><span class="pun">}</span><span class="pln"> exact</span><span class="pun">={</span><span class="pln">activeOnlyWhenExact</span><span class="pun">}</span><span class="pln"> children</span><span class="pun">={({</span><span class="pln">match</span><span class="pun">})</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="pun">(</span></code></li><li class="L2"><code><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">div className</span><span class="pun">={</span><span class="pln">match </span><span class="pun">?</span><span class="pln"> </span><span class="str">'active'</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> </span><span class="str">''</span><span class="pun">}&gt;</span></code></li><li class="L3"><code><span class="pln"> </span><span class="pun">{</span><span class="pln">match </span><span class="pun">?</span><span class="pln"> </span><span class="str">'&gt;'</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> </span><span class="str">''</span><span class="pun">}&lt;</span><span class="typ">Link</span><span class="pln"> to</span><span class="pun">={</span><span class="pln">to</span><span class="pun">}&gt;{</span><span class="pln">label</span><span class="pun">}&lt;/</span><span class="typ">Link</span><span class="pun">&gt;</span></code></li><li class="L4"><code><span class="pln"> </span><span class="pun">&lt;/</span><span class="pln">div</span><span class="pun">&gt;</span></code></li><li class="L5"><code><span class="pln"> </span><span class="pun">)}&gt;&lt;/</span><span class="typ">Route</span><span class="pun">&gt;</span></code></li><li class="L6"><code><span class="pun">);</span></code></li></ol></pre>
                <p><strong>2.3：</strong>上面三种渲染方式都会向下传递三个路由属性(location、match、history)，建议打印到控制台，即可查看具体的信息。<br>match:
                    表示的是如何匹配当前的路由。 </p>
                <pre class="prettyprint linenums prettyprinted"
                    style=""><ol class="linenums"><li class="L0"><code><span class="pun">{</span></code></li><li class="L1"><code><span class="pln"> </span><span class="kwd">params</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Object</span><span class="pun">,</span></code></li><li class="L2"><code><span class="pln"> isExact</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Boolean</span><span class="pun">,</span></code></li><li class="L3"><code><span class="pln"> path</span><span class="pun">:</span><span class="pln"> </span><span class="typ">String</span><span class="pun">,</span></code></li><li class="L4"><code><span class="pln"> url</span><span class="pun">:</span><span class="pln"> </span><span class="typ">String</span></code></li><li class="L5"><code><span class="pun">}</span></code></li></ol></pre>
                <p>location：表示的是当前所在的位置信息。</p>
                <pre class="prettyprint linenums prettyprinted"
                    style=""><ol class="linenums"><li class="L0"><code><span class="pun">{</span></code></li><li class="L1"><code><span class="pln"> pathname</span><span class="pun">:</span><span class="pln"> </span><span class="str">'/somewhere'</span></code></li><li class="L2"><code><span class="pln"> search</span><span class="pun">:</span><span class="pln"> </span><span class="str">'?some=search-string'</span><span class="pun">,</span></code></li><li class="L3"><code><span class="pln"> hash</span><span class="pun">:</span><span class="pln"> </span><span class="str">'#howdy'</span><span class="pun">,</span></code></li><li class="L4"><code><span class="pln"> state</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L5"><code><span class="pln"> </span><span class="pun">[</span><span class="pln">userDefined</span><span class="pun">]:</span><span class="pln"> </span><span class="kwd">true</span></code></li><li class="L6"><code><span class="pln"> </span><span class="pun">}</span></code></li><li class="L7"><code><span class="pun">}</span></code></li></ol></pre>
                <p>history：主要是关于路由的一些信息和操作。</p>
                <pre class="prettyprint linenums prettyprinted"
                    style=""><ol class="linenums"><li class="L0"><code><span class="pln">length </span><span class="pun">-</span><span class="pln"> </span><span class="pun">(</span><span class="pln">number</span><span class="pun">)</span><span class="pln"> </span><span class="typ">The</span><span class="pln"> number of entries </span><span class="kwd">in</span><span class="pln"> the history stack</span></code></li><li class="L1"><code><span class="pln">action </span><span class="pun">-</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">string</span><span class="pun">)</span><span class="pln"> </span><span class="typ">The</span><span class="pln"> current action </span><span class="pun">(</span><span class="pln">PUSH</span><span class="pun">,</span><span class="pln"> REPLACE</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">or</span><span class="pln"> POP</span><span class="pun">)</span></code></li><li class="L2"><code><span class="pln">location </span><span class="pun">-</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">object</span><span class="pun">)</span><span class="pln"> </span><span class="typ">The</span><span class="pln"> current location</span><span class="pun">.</span></code></li><li class="L3"><code><span class="pln">push</span><span class="pun">(</span><span class="pln">path</span><span class="pun">,</span><span class="pln"> </span><span class="pun">[</span><span class="pln">state</span><span class="pun">])</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">function</span><span class="pun">)</span><span class="pln"> </span><span class="typ">Pushes</span><span class="pln"> a </span><span class="kwd">new</span><span class="pln"> entry onto the history stack</span></code></li><li class="L4"><code><span class="pln">replace</span><span class="pun">(</span><span class="pln">path</span><span class="pun">,</span><span class="pln"> </span><span class="pun">[</span><span class="pln">state</span><span class="pun">])</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">function</span><span class="pun">)</span><span class="pln"> </span><span class="typ">Replaces</span><span class="pln"> the current entry on the history stack</span></code></li><li class="L5"><code><span class="pln">go</span><span class="pun">(</span><span class="pln">n</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">function</span><span class="pun">)</span><span class="pln"> </span><span class="typ">Moves</span><span class="pln"> the pointer </span><span class="kwd">in</span><span class="pln"> the history stack </span><span class="kwd">by</span><span class="pln"> n entries</span></code></li><li class="L6"><code><span class="pln">goBack</span><span class="pun">()</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">function</span><span class="pun">)</span><span class="pln"> </span><span class="typ">Equivalent</span><span class="pln"> to go</span><span class="pun">(-</span><span class="lit">1</span><span class="pun">)</span></code></li><li class="L7"><code><span class="pln">goForward</span><span class="pun">()</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">function</span><span class="pun">)</span><span class="pln"> </span><span class="typ">Equivalent</span><span class="pln"> to go</span><span class="pun">(</span><span class="lit">1</span><span class="pun">)</span></code></li><li class="L8"><code><span class="pln">block</span><span class="pun">(</span><span class="pln">prompt</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">function</span><span class="pun">)</span><span class="pln"> </span><span class="typ">Prevents</span><span class="pln"> navigation </span><span class="pun">(</span><span class="pln">see the history docs</span><span class="pun">)</span></code></li></ol></pre>
                <p>提醒：在开发过程中有遇到过使用history.push()方法手动控制路由跳转的时候，会提示没有此方法，这时候就要排查当前props是否有history对象了。在v4版本中，使用<code>&lt;Router&gt;</code>的时候才会默认传入location、match、history这三个对象，否则就需要一级一级的手动传递。但是官网也提供了<code>withRouter</code>组件，可以包装任何自定义组件，当需要用到该三个对象的时候，将组件包一层<code>withRouter</code>，就可以拿到需要的路由信息。
                </p>
                <p><strong>3. <code>&lt;Switch&gt;</code>用法</strong></p>
                <p>这个比较好理解，就是只能匹配地址的第一个<code>&lt;Route&gt;</code>或者<code>&lt;Redirect&gt;</code>，仅仅只能匹配一个路由。举个例子：</p>
                <pre class="prettyprint linenums prettyprinted"
                    style=""><ol class="linenums"><li class="L0"><code><span class="tag">&lt;Switch&gt;</span></code></li><li class="L1"><code><span class="pln"> </span><span class="tag">&lt;Route</span><span class="pln"> </span><span class="atn">exact</span><span class="pln"> </span><span class="atn">path</span><span class="pun">=</span><span class="atv">"/"</span><span class="pln"> </span><span class="atn">component</span><span class="pun">=</span><span class="atv">{Home}</span><span class="tag">/&gt;</span></code></li><li class="L2"><code><span class="pln"> </span><span class="tag">&lt;Route</span><span class="pln"> </span><span class="atn">path</span><span class="pun">=</span><span class="atv">"/about"</span><span class="pln"> </span><span class="atn">component</span><span class="pun">=</span><span class="atv">{About}</span><span class="tag">/&gt;</span></code></li><li class="L3"><code><span class="pln"> </span><span class="tag">&lt;Route</span><span class="pln"> </span><span class="atn">path</span><span class="pun">=</span><span class="atv">"/:user"</span><span class="pln"> </span><span class="atn">component</span><span class="pun">=</span><span class="atv">{User}</span><span class="tag">/&gt;</span></code></li><li class="L4"><code><span class="pln"> </span><span class="tag">&lt;Route</span><span class="pln"> </span><span class="atn">component</span><span class="pun">=</span><span class="atv">{NotFound}</span><span class="tag">/&gt;</span></code></li><li class="L5"><code><span class="tag">&lt;/Switch&gt;</span></code></li></ol></pre>
                <p>若是路由为/about，则只会匹配About，若是路由为/name，则只会匹配User。如果没有<code>&lt;Switch&gt;</code>，当路由为/about时，则About和User都会被匹配。而且一般也用于404页面，当所有路径都没有匹配到时，就会匹配NotFound。
                </p>
                <p><strong>4. <code>&lt;Redirect&gt;</code>用法</strong></p>
                <p>用于路由的跳转。当用户访问一个路由，会自动跳转到另一个路由。<a
                        href="https://reacttraining.com/react-router/web/api/Redirect">官网</a>有详细的各个属性的说明。</p>
                <pre class="prettyprint linenums prettyprinted"
                    style=""><ol class="linenums"><li class="L0"><code><span class="com">//当to为String时</span></code></li><li class="L1"><code><span class="pun">&lt;</span><span class="typ">Redirect</span><span class="pln"> to</span><span class="pun">=</span><span class="str">"/somewhere/else"</span><span class="pln"> </span><span class="pun">/&gt;</span></code></li><li class="L2"><code><span class="com">//当to为Object时</span></code></li><li class="L3"><code><span class="pun">&lt;</span><span class="typ">Redirect</span></code></li><li class="L4"><code><span class="pln"> to</span><span class="pun">={{</span></code></li><li class="L5"><code><span class="pln"> pathname</span><span class="pun">:</span><span class="pln"> </span><span class="str">"/login"</span><span class="pun">,</span></code></li><li class="L6"><code><span class="pln"> search</span><span class="pun">:</span><span class="pln"> </span><span class="str">"?utm=your+face"</span><span class="pun">,</span></code></li><li class="L7"><code><span class="pln"> state</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> referrer</span><span class="pun">:</span><span class="pln"> currentLocation </span><span class="pun">}</span></code></li><li class="L8"><code><span class="pln"> </span><span class="pun">}}</span></code></li><li class="L9"><code><span class="pun">/&gt;</span></code></li></ol></pre>
                <p>使用的时候建议to为Object。举个场景：比如某个页面需要登陆认证才能访问，当没有登陆就去访问的时候，就会跳转到登陆界面，这时可以设置referrer属性的值为当前的路由，登陆成功后就可以根据referrer属性的值跳转到先前需要访问的页面，对于用户体验是非常不错的。
                </p>
                <p><strong>4. <code>&lt;Link&gt;</code>用法</strong><br>指的是跳转，类似平时的href。 </p>
                <pre class="prettyprint linenums prettyprinted"
                    style=""><ol class="linenums"><li class="L0"><code><span class="com">//to（string / object）：要跳转的路径或地址；</span></code></li><li class="L1"><code><span class="com">//replace ：为 true 时，点击链接后将使用新地址替换掉访问历史记录里面的原地址；为 false 时，点击链接后将在原有访问历史记录的基础上添加一个新的纪录。默认为 false；</span></code></li><li class="L2"><code></code></li><li class="L3"><code><span class="com">//用法如下</span></code></li><li class="L4"><code><span class="com">//当to为string类型的时候</span></code></li><li class="L5"><code><span class="pun">&lt;</span><span class="typ">Link</span><span class="pln"> to</span><span class="pun">=</span><span class="str">"/about"</span><span class="pun">&gt;</span><span class="typ">About</span><span class="pun">&lt;/</span><span class="typ">Link</span><span class="pun">&gt;</span></code></li><li class="L6"><code><span class="com">//当携带参数的时候</span></code></li><li class="L7"><code><span class="pun">&lt;</span><span class="typ">Link</span><span class="pln"> to</span><span class="pun">=</span><span class="str">"/courses?sort=name"</span><span class="pln"> </span><span class="pun">/&gt;</span></code></li><li class="L8"><code></code></li><li class="L9"><code><span class="com">//当to为obj的时候</span></code></li><li class="L0"><code><span class="pun">&lt;</span><span class="typ">Link</span><span class="pln"> to</span><span class="pun">={{</span></code></li><li class="L1"><code><span class="pln"> pathname</span><span class="pun">:</span><span class="pln"> </span><span class="str">'/courses'</span><span class="pun">,</span></code></li><li class="L2"><code><span class="pln"> search</span><span class="pun">:</span><span class="pln"> </span><span class="str">'?sort=name'</span><span class="pun">,</span></code></li><li class="L3"><code><span class="pln"> hash</span><span class="pun">:</span><span class="pln"> </span><span class="str">'#the-hash'</span><span class="pun">,</span></code></li><li class="L4"><code><span class="pln"> state</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> fromDashboard</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">true</span><span class="pln"> </span><span class="pun">}</span></code></li><li class="L5"><code><span class="pun">}}/&gt;</span></code></li><li class="L6"><code></code></li><li class="L7"><code><span class="com">// replace 用法</span></code></li><li class="L8"><code><span class="pun">&lt;</span><span class="typ">Link</span><span class="pln"> to</span><span class="pun">=</span><span class="str">"/courses"</span><span class="pln"> replace </span><span class="pun">/&gt;</span></code></li></ol></pre>
                <p><strong>4. <code>&lt;NavLink&gt;</code>用法</strong></p>
                <p><code>&lt;NavLink&gt;</code>是一个特定的<code>&lt;Link&gt;</code>类型，会在匹配上当前URL的时候给已经渲染的元素添加样式，一般用于功能菜单切换时显示激活状态，代替开发人员去实现该效果。<a
                        href="https://reacttraining.com/react-router/web/api/NavLink">官网链接</a>有具体的介绍，看过demo应该就比较清楚了，这里就不详细说了。
                </p>
                <hr>
                <p><strong>总结</strong>：以上就是本次项目开发过程中用到的关于React-Router的一些知识点，踩了很多坑，但是收获颇丰。而且还有很多其他的新特性没有用到，相信在后续的功能扩展开发会继续踩坑，多积累经验。有兴趣的可以去<a
                        href="https://reacttraining.com/react-router/web/guides/quick-start">React-Router官网</a>看一下，虽然是全英文描述，但是结构层次非常明确，结合demo基本都能看懂。
                </p>
                <p>欢迎转载，转载请注明出处。</p>
            </div>
        </div>
    </main>
    <footer class="footer">
        <div class="footer-link">
            <div>© 2018 - 2019</div>
            <div><a target="_blank" href="http://github.com/hcLei"><img src="../../public/images/github.svg"
                        alt="github"></a></div>
            <div><a target="_blank"
                    href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&email=BzY0MTc0Pj81MjFHdnYpZGhq"><img
                        src="../../public/images/email.svg" alt="email"></a></div>
        </div>
        <div class="footer-info">
            <div><img src="../../public/images/computer.svg" alt="computer"><a target="_blank"
                    href="http://www.miibeian.gov.cn">渝ICP备16007578号</a></div>
        </div>
    </footer>
</body>

</html>